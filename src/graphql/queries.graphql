fragment FullSEO on SeoField {
  title
  description
  image {
    url
  }
  twitterCard
}

fragment FullMarket on MarketRecord {
  title
  lead
  slug
  tile {
    url
  }
  blocks {
    ...DownloadTeaserBlock
    ...ExternalVideoBlock
    ...GalleryBlock
    ...IframeBlock
    ...MarkdownBlock
    ...SurveyBlock
  }
  seo {
    ...FullSEO
  }
}

fragment FullTheme on ThemeRecord {
  title
  lead
  slug
  tile {
    url
  }
  blocks {
    ...DownloadTeaserBlock
    ...ExternalVideoBlock
    ...GalleryBlock
    ...IframeBlock
    ...MarkdownBlock
    ...SurveyBlock
  }
  seo {
    ...FullSEO
  }
}

fragment FullBlogPost on BlogPostRecord {
  title
  lead
  slug
  image {
    url
  }
  blocks {
    ...DownloadTeaserBlock
    ...ExternalVideoBlock
    ...GalleryBlock
    ...IframeBlock
    ...MarkdownBlock
    ...SurveyBlock
  }
  markets {
    title
  }
  themes {
    title
  }
  _firstPublishedAt
}

# Blocks
fragment DownloadTeaserBlock on DownloadTeaserBlockRecord {
  markdown
  description
  assets {
    title
    file {
      url
    }
  }
}

fragment ExternalVideoBlock on ExternalVideoBlockRecord {
  externalVideoUrl: url {
    url
    title
  }
}

fragment GalleryBlock on GalleryBlockRecord {
  assets {
    title
    url
  }
}

fragment IframeBlock on IframeBlockRecord {
  iFrameUrl: url
}

fragment ImageTeaserBlock on ImageTeaserBlockRecord {
  description
  asset {
    title
    alt
    url
  }
}

fragment MarkdownBlock on MarkdownBlockRecord {
  content
}

fragment SurveyBlock on SurveyBlockRecord {
  formUrl
  question {
    question
    formFieldId
    isMultipleChoice
    possibleAnswers {
      answer
    }
  }
}

# Queries
query HomePage($locale: SiteLocale!) {
  homePage(locale: $locale) {
    title
    lead
    seo {
      ...FullSEO
    }
  }

  allMarkets(locale: $locale) {
    ...FullMarket
  }

  allThemes(locale: $locale) {
    ...FullTheme
  }

  allBlogPosts(locale: $locale, first: 3) {
    ...FullBlogPost
  }
}

query MarketPage($locale: SiteLocale!, $slug: String!) {
  market(locale: $locale, filter: { slug: { eq: $slug } }) {
    ...FullMarket

    _allSlugLocales {
      locale
      value
    }
  }

  allMarkets(locale: $locale) {
    ...FullMarket
  }

  allBlogPosts(locale: $locale, first: 3) {
    ...FullBlogPost
  }
}

query AllMarketsSlugLocales {
  allMarkets {
    _allSlugLocales {
      locale
      value
    }
  }
}

query ThemePage($locale: SiteLocale!, $slug: String!) {
  theme(locale: $locale, filter: { slug: { eq: $slug } }) {
    ...FullTheme

    _allSlugLocales {
      locale
      value
    }
  }

  allThemes(locale: $locale) {
    ...FullTheme
  }

  allBlogPosts(locale: $locale, first: 3) {
    ...FullBlogPost
  }
}

query AllThemesSlugLocales {
  allThemes {
    _allSlugLocales {
      locale
      value
    }
  }
}

query BlogPage($locale: SiteLocale!) {
  blogPage(locale: $locale) {
    title
    lead
    seo {
      ...FullSEO
    }
  }

  allMarkets(locale: $locale) {
    ...FullMarket
  }

  allBlogPosts(locale: $locale) {
    ...FullBlogPost
  }
}

query AboutPage($locale: SiteLocale!) {
  aboutPage(locale: $locale) {
    title
    lead
  }

  allMarkets(locale: $locale) {
    ...FullMarket
  }
}
