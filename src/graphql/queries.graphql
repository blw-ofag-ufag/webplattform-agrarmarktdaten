# Queries
## Regular
query HomePage($locale: SiteLocale!) {
  homePage(locale: $locale) {
    _allSlugLocales {
      locale
      value
    }
    id
    title
    lead {
      value
      links {
        __typename
        ...InternalLink
      }
    }
    hero {
      id
      url
    }
    seo {
      ...FullSEO
    }
    markets {
      id
      title
      slug
    }

    focusArticles {
      id
      title
      slug
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }

  topBlogPosts: allBlogPosts(locale: $locale, first: 3) {
    ...SimpleBlogPost
  }
}

query DataPage($locale: SiteLocale!) {
  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }
}

query LegalPage($locale: SiteLocale!) {
  legalPage(locale: $locale) {
    id
    title
    slug
    lead {
      value
      links {
        __typename
        ...InternalLink
      }
    }
    content {
      value
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }
}

query TermsPage($locale: SiteLocale!) {
  termsPage(locale: $locale) {
    title
    slug
    lead {
      value
      links {
        __typename
        ...InternalLink
      }
    }
    content {
      value
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }
}

query MarketPage($locale: SiteLocale!, $slug: String!) {
  marketArticle(locale: $locale, filter: { slug: { eq: $slug } }) {
    _allSlugLocales {
      locale
      value
    }
    ...FullMarketArticle
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }

  topBlogPosts: allBlogPosts(locale: $locale, first: 3) {
    ...SimpleBlogPost
  }
}

query FocusArticlePage($locale: SiteLocale!, $slug: String!) {
  focusArticle(locale: $locale, filter: { slug: { eq: $slug } }) {
    _allSlugLocales {
      locale
      value
    }
    ...FullFocusArticle
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }

  topBlogPosts: allBlogPosts(locale: $locale, first: 3) {
    ...SimpleBlogPost
  }
}

query MethodsPage($locale: SiteLocale!) {
  methodsPage(locale: $locale) {
    _allSlugLocales {
      locale
      value
    }
    id
    title
    lead {
      value
      links {
        __typename
        ...InternalLink
      }
    }
    seo {
      ...FullSEO
    }
    content {
      value
      blocks {
        __typename
        ...DataButton
        ...ImageTeaserBlock
      }
      links {
        __typename
        ...FileDownloadSection
        ...HighlightSection
        ...PowerBI
      }
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }

  topBlogPosts: allBlogPosts(locale: $locale, first: 3) {
    ...SimpleBlogPost
  }
}

query AnalysisPage($locale: SiteLocale!) {
  analysisPage(locale: $locale) {
    id
    title
    lead {
      value
      links {
        __typename
        ...InternalLink
      }
    }
    seo {
      ...FullSEO
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }
}

query paginatedFilteredBlogposts(
  $locale: SiteLocale!
  $first: IntType!
  $skip: IntType!
  $marketFilter: ItemId
  $focusFilter: ItemId
) {
  blogposts: allBlogPosts(
    locale: $locale
    first: $first
    skip: $skip
    filter: {
      OR: [{ markets: { anyIn: [$marketFilter] } }, { focusArticles: { anyIn: [$focusFilter] } }]
    }
  ) {
    ...SimpleBlogPost
  }
  blogpostCount: _allBlogPostsMeta(
    locale: $locale
    filter: {
      OR: [{ markets: { anyIn: [$marketFilter] } }, { focusArticles: { anyIn: [$focusFilter] } }]
    }
  ) {
    count
  }
}

query paginatedBlogposts($locale: SiteLocale!, $first: IntType!, $skip: IntType!) {
  blogposts: allBlogPosts(locale: $locale, first: $first, skip: $skip) {
    ...SimpleBlogPost
  }
  blogpostCount: _allBlogPostsMeta(locale: $locale) {
    count
  }
}

query BlogPost($locale: SiteLocale!, $slug: String!) {
  blogPost(locale: $locale, filter: { slug: { eq: $slug } }) {
    ...BlogPost
    id

    _allSlugLocales {
      locale
      value
    }
  }

  allMarketArticles(locale: $locale) {
    ...SimpleMarketArticle
  }

  allFocusArticles(locale: $locale) {
    ...SimpleFocusArticle
  }

  topBlogPosts: allBlogPosts(locale: $locale, first: 3) {
    ...SimpleBlogPost
  }
}

query AllPowerBIReports($locale: SiteLocale!) {
  allPowerBiReports(locale: $locale) {
    id
    reportId
    dataset {
      datasetId
    }
    workspace {
      workspaceId
    }
  }
}

## Slugs
query AllMarketArticlesSlugLocales {
  allMarketArticles {
    id
    _allSlugLocales {
      locale
      value
    }
  }
}

query AllFocusArticlesSlugLocales {
  allFocusArticles {
    id
    _allSlugLocales {
      locale
      value
    }
  }
}

query AllBlogPostsSlugLocales {
  allBlogPosts {
    id
    _allSlugLocales {
      locale
      value
    }
  }
}

# Fragments
fragment FullSEO on SeoField {
  title
  description
  image {
    id
    url
  }
  twitterCard
}

fragment SimpleMarketArticle on MarketArticleRecord {
  id
  title
  slug
}

fragment SimpleFocusArticle on FocusArticleRecord {
  id
  title
  slug
}

fragment FullMarketArticle on MarketArticleRecord {
  id
  title
  slug
  lead {
    value
    links {
      __typename
      ...InternalLink
    }
  }
  content {
    value
    blocks {
      __typename
      ...DataButton
      ...ImageTeaserBlock
    }
    links {
      __typename
      ...FileDownloadSection
      ...HighlightSection
      ...PowerBI
    }
  }
  seo {
    ...FullSEO
  }
}

fragment FullFocusArticle on FocusArticleRecord {
  id
  title
  slug
  lead {
    value
    links {
      __typename
      ...InternalLink
    }
  }
  content {
    value

    blocks {
      __typename
      ...DataButton
      ...ImageTeaserBlock
    }
    links {
      __typename
      ...FileDownloadSection
      ...HighlightSection
      ...PowerBI
    }
  }
  seo {
    ...FullSEO
  }
}

fragment SimpleBlogPost on BlogPostRecord {
  id
  title
  slug
  leadCard
  image {
    id
    alt
    url
    responsiveImage(imgixParams: { fit: fill, w: 1096, h: 556, auto: format }) {
      sizes
      src
      width
      height
      alt
      title
      base64
    }
  }
  markets {
    id
    title
    slug
  }
  focusArticles {
    id
    title
    slug
  }
  publishedDate
}

fragment BlogPost on BlogPostRecord {
  id
  publishedDate
  title
  leadCard
  lead {
    value
    links {
      __typename
      ...InternalLink
    }
  }
  slug
  authors {
    id
    firstName
    lastName
    portrait {
      id
      url
    }
  }
  markets {
    id
    title
    slug
  }
  focusArticles {
    id
    title
    slug
  }
  content {
    value
    blocks {
      __typename
      ...DataButton
      ...ImageTeaserBlock
    }
    links {
      __typename
      ...FileDownloadSection
      ...HighlightSection
      ...PowerBI
    }
  }
}

# Blocks
fragment DownloadTeaserBlock on DownloadTeaserBlockRecord {
  id
  markdown
  description
  downloadTeaserAssets {
    id
    title
    file {
      id
      url
    }
  }
}

fragment ExternalVideoBlock on ExternalVideoBlockRecord {
  id
  externalVideo {
    url
    title
  }
}

fragment GalleryBlock on GalleryBlockRecord {
  id
  galleryAssets {
    id
    title
    url
  }
}

fragment IframeBlock on IframeBlockRecord {
  id
  url
}

fragment MarkdownBlock on MarkdownBlockRecord {
  id
  content
}

fragment SurveyBlock on SurveyBlockRecord {
  id
  formUrl
  question {
    id
    question
    formFieldId
    isMultipleChoice
    possibleAnswers {
      id
      answer
    }
  }
}

fragment ImageTeaserBlock on ImageTeaserBlockRecord {
  id
  imageTeaserAsset {
    customData
    id
    url
    alt
    width
    height
    responsiveImage(imgixParams: { fit: fill, w: 1096, h: 556, auto: format }) {
      sizes
      src
      width
      height
      alt
      title
      base64
    }
  }
}

fragment PowerBI on PowerBiReportRecord {
  id
  workspace {
    id
    name
    workspaceId
  }
  reportId
  name
  dataset {
    name
    id
    datasetId
    workspace {
      workspaceId
      name
      id
    }
  }
}

fragment FileDownloadSection on FileDownloadSectionRecord {
  id
  title
  fileDownloadItems {
    id
    title
    description
    date
    file {
      url
      format
    }
  }
}

fragment HighlightSection on HighlightSectionRecord {
  id
  title
  content {
    # blocks {
    #   id
    #   __typename
    # }
    links {
      __typename
      ...HighlightSectionFileRecord
      ...HighlightSectionLink
    }
    value
  }
}

fragment HighlightSectionFileRecord on HighlightSectionFileRecord {
  id
  title
  file {
    url
  }
}

fragment HighlightSectionLink on HighlightSectionLinkRecord {
  id
  title
  link {
    __typename
    ... on BlogPostRecord {
      id
      slug
    }
    ... on FocusArticleRecord {
      id
      slug
    }
    ... on MarketArticleRecord {
      id
      slug
    }
    ... on MethodsPageRecord {
      id
      slug
    }
  }
}

fragment DataButton on DataButtonRecord {
  id
  url
  label
}

fragment InternalLink on RecordInterface {
  ... on HomePageRecord {
    id
  }
  ... on AboutPageRecord {
    id
  }
  ... on AnalysisPageRecord {
    id
  }
  ... on FocusArticleRecord {
    id
    slug
  }
  ... on LegalPageRecord {
    id
  }
  ... on MarketArticleRecord {
    id
    slug
  }
  ... on MethodsPageRecord {
    id
  }
  ... on TermsPageRecord {
    id
  }
  ... on BlogPostRecord {
    id
    slug
  }
}
